# å…¨è‡ªåŠ¨è¿­ä»£å¼€å‘å·¥ä½œæµ

> **å·¥ä½œæµ ID**: auto-iterate
> **è§¦å‘å‘½ä»¤**: `*auto-iterate`
> **æ™ºèƒ½ä½“**: Phoenix (å…¨è‡ªåŠ¨åŒ–è¿­ä»£å¼€å‘ç¼–æ’å™¨)

---

## çŸ¥è¯†åº“é›†æˆ

### çŸ¥è¯†åº“é…ç½®

```yaml
knowledge_base:
  # å½“å‰æ¨¡å¼: rag (å‰æœŸ) | mcp (åæœŸ)
  mode: "rag"

  # RAG æ¨¡å¼é…ç½®
  rag:
    file_path: "{project-root}/docs/rag/rag.md"

  # MCP æ¨¡å¼é…ç½® (æœªæ¥)
  mcp:
    server: "knowledge-base-mcp"
    endpoint: "mcp__kb__query"
```

### çŸ¥è¯†åº“è°ƒç”¨æœºåˆ¶

åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°ä»¥ä¸‹åœºæ™¯æ—¶ä¼šè‡ªåŠ¨æŸ¥è¯¢çŸ¥è¯†åº“ï¼š

| é˜¶æ®µ | è°ƒç”¨åœºæ™¯ | æŸ¥è¯¢ç±»å‹ |
|-----|---------|---------|
| Phase 1 | é‡åˆ°ä¸šåŠ¡æœ¯è¯­ | ä¸šåŠ¡ |
| Phase 1 | è¯†åˆ«åŠŸèƒ½éœ€æ±‚æ—¶éªŒè¯ä¸šåŠ¡è§„åˆ™ | ä¸šåŠ¡ |
| Phase 1 | åˆ†æä¸šåŠ¡æµç¨‹ | ä¸šåŠ¡ |
| Phase 2 | åˆ›å»ºç”¨æˆ·æ•…äº‹æ—¶æŸ¥è¯¢è§’è‰²å®šä¹‰ | ä¸šåŠ¡ |
| Phase 2 | å®šä¹‰éªŒæ”¶æ ‡å‡†æ—¶æŸ¥è¯¢å‚è€ƒæ¨¡æ¿ | ä¸šåŠ¡+æŠ€æœ¯ |
| Phase 2 | å®šä¹‰NFRæ—¶æŸ¥è¯¢æ ‡å‡† | æŠ€æœ¯ |
| Phase 3 | æŠ€æœ¯é€‰å‹æ—¶æŸ¥è¯¢è§„èŒƒ | æŠ€æœ¯ |
| Phase 3 | æ¶æ„è®¾è®¡æ—¶æŸ¥è¯¢æ¨¡å¼ | æŠ€æœ¯ |
| Phase 3 | APIè®¾è®¡æ—¶æŸ¥è¯¢è§„èŒƒ | æŠ€æœ¯ |
| Phase 4 | ç¼–å†™ä»£ç æ—¶æŸ¥è¯¢ç¼–ç è§„èŒƒ | æŠ€æœ¯ |
| Phase 4 | å®ç°ä¸šåŠ¡é€»è¾‘æ—¶æŸ¥è¯¢è§„åˆ™ | ä¸šåŠ¡ |
| Phase 4 | ç¼–å†™æµ‹è¯•æ—¶æŸ¥è¯¢æµ‹è¯•è§„èŒƒ | æŠ€æœ¯ |
| Phase 5 | éªŒè¯è¦†ç›–ç‡æ—¶æŸ¥è¯¢è¦æ±‚ | æŠ€æœ¯ |
| Phase 5 | è´¨é‡é—¨ç¦æ£€æŸ¥æ—¶æŸ¥è¯¢æ ‡å‡† | æŠ€æœ¯ |

**è¯¦ç»†è°ƒç”¨ç‚¹å®šä¹‰**: å‚è§ `knowledge-base/kb-call-points.md`

---

## å·¥ä½œæµæ¦‚è¿°

æœ¬å·¥ä½œæµå®ç°ä»éœ€æ±‚æ–‡æ¡£åˆ°ä»£ç å®ç°çš„å…¨è‡ªåŠ¨åŒ–æ‰§è¡Œï¼Œèåˆ7å¤§æ™ºèƒ½ä½“èƒ½åŠ›ï¼Œé€šè¿‡çŸ¥è¯†åº“é©±åŠ¨æ‰€æœ‰å†³ç­–ï¼Œå®ç°é›¶äººå·¥å¹²é¢„çš„ç«¯åˆ°ç«¯å¼€å‘ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å…¨è‡ªåŠ¨è¿­ä»£å¼€å‘æµç¨‹                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¾“å…¥                                                                    â”‚
â”‚  â”œâ”€ ğŸ“„ è¿­ä»£éœ€æ±‚æ–‡æ¡£ï¼ˆäº§å“ç»ç†æä¾›ï¼‰                                        â”‚
â”‚  â”œâ”€ ğŸ“š ä¸šåŠ¡çŸ¥è¯†åº“ï¼ˆä¸šåŠ¡è§„åˆ™ã€é¢†åŸŸçŸ¥è¯†ï¼‰                                     â”‚
â”‚  â””â”€ ğŸ”§ æŠ€æœ¯çŸ¥è¯†åº“ï¼ˆæŠ€æœ¯è§„èŒƒã€ä»£ç è§„èŒƒã€æ¶æ„æ¨¡å¼ï¼‰                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase 1: éœ€æ±‚åˆ†æ [Analyst èƒ½åŠ›]                                        â”‚
â”‚  â”œâ”€ è§£æéœ€æ±‚æ–‡æ¡£                                                         â”‚
â”‚  â”œâ”€ åŒ¹é…ä¸šåŠ¡çŸ¥è¯†åº“è§„åˆ™                                                    â”‚
â”‚  â”œâ”€ è¯†åˆ«éšå«éœ€æ±‚å’Œçº¦æŸ                                                    â”‚
â”‚  â””â”€ è¾“å‡º: ç»“æ„åŒ–éœ€æ±‚åˆ†ææŠ¥å‘Š                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase 2: éœ€æ±‚è§„åˆ’ [PM + PO èƒ½åŠ›]                                        â”‚
â”‚  â”œâ”€ åˆ›å»º PRD æ–‡æ¡£                                                        â”‚
â”‚  â”œâ”€ å®šä¹‰åŠŸèƒ½éœ€æ±‚ (FRs)                                                   â”‚
â”‚  â”œâ”€ å®šä¹‰éåŠŸèƒ½éœ€æ±‚ (NFRs)                                                â”‚
â”‚  â”œâ”€ åˆ›å»ºå²è¯—å’Œç”¨æˆ·æ•…äº‹                                                    â”‚
â”‚  â””â”€ è¾“å‡º: PRD + Epic + Stories                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase 3: æ¶æ„è®¾è®¡ [Architect èƒ½åŠ›]                                      â”‚
â”‚  â”œâ”€ åˆ†æç°æœ‰ä»£ç æ¶æ„                                                      â”‚
â”‚  â”œâ”€ è®¾è®¡æŠ€æœ¯æ–¹æ¡ˆ                                                         â”‚
â”‚  â”œâ”€ åŒ¹é…æŠ€æœ¯çŸ¥è¯†åº“è§„èŒƒ                                                    â”‚
â”‚  â”œâ”€ åˆ›å»ºæ•°æ®æ¨¡å‹è®¾è®¡                                                      â”‚
â”‚  â””â”€ è¾“å‡º: æ¶æ„è®¾è®¡æ–‡æ¡£ + ADR                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase 4: å¼€å‘å®ç° [SM + DEV èƒ½åŠ›]                                       â”‚
â”‚  â”œâ”€ Sprint è§„åˆ’                                                         â”‚
â”‚  â”œâ”€ For Each Story:                                                     â”‚
â”‚  â”‚   â”œâ”€ åˆ›å»ºæ•…äº‹ä¸Šä¸‹æ–‡                                                   â”‚
â”‚  â”‚   â”œâ”€ TDD é©±åŠ¨å®ç°                                                    â”‚
â”‚  â”‚   â”œâ”€ ä»£ç å®¡æŸ¥                                                        â”‚
â”‚  â”‚   â””â”€ æ›´æ–°çŠ¶æ€                                                        â”‚
â”‚  â””â”€ è¾“å‡º: å®ç°çš„ä»£ç  + æµ‹è¯•                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase 5: æµ‹è¯•éªŒè¯ [TEA èƒ½åŠ›]                                            â”‚
â”‚  â”œâ”€ æ‰§è¡Œå•å…ƒæµ‹è¯•                                                         â”‚
â”‚  â”œâ”€ æ‰§è¡Œé›†æˆæµ‹è¯•                                                         â”‚
â”‚  â”œâ”€ è´¨é‡é—¨ç¦æ£€æŸ¥                                                         â”‚
â”‚  â””â”€ è¾“å‡º: æµ‹è¯•æŠ¥å‘Š + è´¨é‡æŠ¥å‘Š                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¾“å‡º                                                                    â”‚
â”‚  â”œâ”€ âœ… å®Œæ•´çš„ä»£ç å®ç°                                                     â”‚
â”‚  â”œâ”€ âœ… å®Œæ•´çš„æµ‹è¯•è¦†ç›–                                                     â”‚
â”‚  â”œâ”€ âœ… å®Œæ•´çš„æ–‡æ¡£äº§å‡º                                                     â”‚
â”‚  â””â”€ âœ… æ‰§è¡ŒæŠ¥å‘Šå’Œè¿½æº¯è®°å½•                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ‰§è¡ŒæŒ‡ä»¤

å½“ç”¨æˆ·è¾“å…¥ `*auto-iterate` æ—¶ï¼ŒæŒ‰ä»¥ä¸‹æµç¨‹è‡ªåŠ¨æ‰§è¡Œï¼š

### Step 0: åˆå§‹åŒ–

```markdown
## åˆå§‹åŒ–æ£€æŸ¥æ¸…å•

1. **æ£€æŸ¥å¿…è¦è¾“å…¥**
   - [ ] è¿­ä»£éœ€æ±‚æ–‡æ¡£è·¯å¾„æˆ–å†…å®¹
   - [ ] ç›®æ ‡é¡¹ç›®è·¯å¾„

2. **åŠ è½½çŸ¥è¯†åº“ (RAG æ¨¡å¼)**
   - è¯»å– `{project-root}/docs/rag/rag.md` æ–‡ä»¶
   - è§£æçŸ¥è¯†åº“ç»“æ„ï¼ˆä¸šåŠ¡çŸ¥è¯† + æŠ€æœ¯çŸ¥è¯†ï¼‰
   - æ„å»ºå…³é”®è¯ç´¢å¼•

3. **åˆ›å»ºæ‰§è¡ŒçŠ¶æ€æ–‡ä»¶**
   - åˆ›å»º `auto-iteration-status.yaml`
   - è®°å½•å¼€å§‹æ—¶é—´å’Œåˆå§‹çŠ¶æ€
   - è®°å½•çŸ¥è¯†åº“åŠ è½½çŠ¶æ€
```

**æ‰§è¡ŒåŠ¨ä½œ**ï¼š

```
## å¯åŠ¨å…¨è‡ªåŠ¨è¿­ä»£å¼€å‘

### ç¬¬ä¸€æ­¥ï¼šåŠ è½½çŸ¥è¯†åº“

æ­£åœ¨è¯»å–çŸ¥è¯†åº“æ–‡ä»¶: {project-root}/docs/rag/rag.md

**çŸ¥è¯†åº“åŠ è½½ç»“æœ**:
- ä¸šåŠ¡æœ¯è¯­: X æ¡
- ä¸šåŠ¡è§„åˆ™: X æ¡
- ä¸šåŠ¡æµç¨‹: X æ¡
- æŠ€æœ¯è§„èŒƒ: X æ¡
- ç¼–ç è§„èŒƒ: X æ¡
- æ¶æ„æ¨¡å¼: X æ¡

âœ… çŸ¥è¯†åº“åŠ è½½å®Œæˆ

### ç¬¬äºŒæ­¥ï¼šè¯·æä¾›è¿­ä»£éœ€æ±‚

è¯·ç²˜è´´äº§å“ç»ç†æä¾›çš„è¿­ä»£éœ€æ±‚æ–‡æ¡£å†…å®¹ï¼š

### ç¬¬ä¸‰æ­¥ï¼šç¡®è®¤é¡¹ç›®è·¯å¾„

ç›®æ ‡ä»£ç åº“è·¯å¾„: {project-root}
ç¡®è®¤åå°†å¼€å§‹å…¨è‡ªåŠ¨æ‰§è¡Œã€‚
```

**çŸ¥è¯†åº“æŸ¥è¯¢ç¤ºä¾‹**ï¼š

åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“é‡åˆ°éœ€è¦æŸ¥è¯¢çŸ¥è¯†åº“çš„åœºæ™¯æ—¶ï¼Œå°†æŒ‰ä»¥ä¸‹æ ¼å¼æ‰§è¡Œï¼š

```yaml
# çŸ¥è¯†åº“æŸ¥è¯¢
call_point: "KBC-1.2"
question: "è¯·æŸ¥è¯¢ä¸ç”¨æˆ·åå¥½è®¾ç½®ç›¸å…³çš„ä¸šåŠ¡è§„åˆ™"
source: "{project-root}/docs/rag/rag.md"

# æ‰§è¡Œæ­¥éª¤
1. æå–å…³é”®è¯: ["ç”¨æˆ·", "åå¥½", "è®¾ç½®", "ä¸šåŠ¡è§„åˆ™"]
2. åœ¨ rag.md ä¸­æœç´¢åŒ¹é…ç« èŠ‚
3. è¿”å›åŒ¹é…å†…å®¹

# æŸ¥è¯¢ç»“æœ
found: true
content: |
  ### è§„åˆ™: BR-003 åå¥½è®¾ç½®è§„åˆ™
  - æ¯ä¸ªç”¨æˆ·å¯è®¾ç½®æœ€å¤š100ä¸ªåå¥½é¡¹
  - åå¥½é”®åé•¿åº¦ä¸è¶…è¿‡100å­—ç¬¦
  - ...
source_section: "ä¸šåŠ¡è§„åˆ™ > BR-003"
confidence: "high"

# å†³ç­–
åŸºäºçŸ¥è¯†åº“ BR-003 è§„åˆ™ï¼Œå®ç°ä¸­å¿…é¡»ï¼š
1. é™åˆ¶åå¥½æ•°é‡ä¸º100
2. éªŒè¯é”®åé•¿åº¦
3. ...
```

---

### Step 1: éœ€æ±‚åˆ†æé˜¶æ®µ (Phase 1)

**è§’è‰²æ¿€æ´»**: Analyst (éœ€æ±‚åˆ†æå¸ˆ)

**è‡ªåŠ¨æ‰§è¡Œå†…å®¹**:

```yaml
phase: 1
name: éœ€æ±‚åˆ†æ
role: Analyst
inputs:
  - è¿­ä»£éœ€æ±‚æ–‡æ¡£
  - ä¸šåŠ¡çŸ¥è¯†åº“
outputs:
  - requirement-analysis.md

tasks:
  - name: è§£æéœ€æ±‚æ–‡æ¡£
    action: |
      1. è¯»å–éœ€æ±‚æ–‡æ¡£å…¨æ–‡
      2. æå–åŠŸèƒ½ç‚¹åˆ—è¡¨
      3. æå–ä¸šåŠ¡è§„åˆ™
      4. æå–çº¦æŸæ¡ä»¶

  - name: åŒ¹é…ä¸šåŠ¡çŸ¥è¯†åº“
    action: |
      1. åœ¨çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¸šåŠ¡è§„åˆ™
      2. éªŒè¯éœ€æ±‚ä¸ç°æœ‰ä¸šåŠ¡è§„åˆ™çš„ä¸€è‡´æ€§
      3. è¯†åˆ«éœ€è¦æ–°å¢çš„ä¸šåŠ¡è§„åˆ™
      4. æ ‡è®°æ½œåœ¨çš„ä¸šåŠ¡å†²çª

  - name: è¯†åˆ«éšå«éœ€æ±‚
    action: |
      1. åŸºäºä¸šåŠ¡çŸ¥è¯†æ¨æ–­éšå«éœ€æ±‚
      2. åŸºäºæŠ€æœ¯çº¦æŸæ¨æ–­éåŠŸèƒ½éœ€æ±‚
      3. åŸºäºç”¨æˆ·åœºæ™¯æ¨æ–­è¾¹ç•Œæ¡ä»¶

  - name: ç”Ÿæˆåˆ†ææŠ¥å‘Š
    output: requirement-analysis.md
    template: |
      # éœ€æ±‚åˆ†ææŠ¥å‘Š

      ## 1. éœ€æ±‚æ¦‚è¿°
      [ä»éœ€æ±‚æ–‡æ¡£æå–çš„æ ¸å¿ƒéœ€æ±‚æè¿°]

      ## 2. åŠŸèƒ½ç‚¹æ¸…å•
      | ID | åŠŸèƒ½ç‚¹ | ä¼˜å…ˆçº§ | çŸ¥è¯†åº“åŒ¹é… |
      |----|-------|-------|-----------|

      ## 3. ä¸šåŠ¡è§„åˆ™åŒ¹é…
      ### å·²åŒ¹é…çš„ä¸šåŠ¡è§„åˆ™
      [ä»çŸ¥è¯†åº“åŒ¹é…åˆ°çš„è§„åˆ™]

      ### æ–°å¢ä¸šåŠ¡è§„åˆ™
      [éœ€è¦æ–°å¢çš„è§„åˆ™]

      ## 4. éšå«éœ€æ±‚
      [æ¨æ–­å‡ºçš„éšå«éœ€æ±‚]

      ## 5. çº¦æŸå’Œé£é™©
      [è¯†åˆ«çš„çº¦æŸæ¡ä»¶å’Œæ½œåœ¨é£é™©]

      ## 6. ä¸‹ä¸€é˜¶æ®µè¾“å…¥
      [ä¸º Phase 2 å‡†å¤‡çš„ç»“æ„åŒ–è¾“å…¥]
```

**è´¨é‡é—¨ç¦**:
- [ ] æ‰€æœ‰åŠŸèƒ½ç‚¹éƒ½å·²è¯†åˆ«
- [ ] ä¸šåŠ¡è§„åˆ™åŒ¹é…ç‡ > 80%
- [ ] æ— æœªè§£å†³çš„ä¸šåŠ¡å†²çª

**é˜»å¡å¤„ç†**:
- å¦‚æœä¸šåŠ¡è§„åˆ™åŒ¹é…ç‡ < 80%ï¼Œè‡ªåŠ¨åœ¨çŸ¥è¯†åº“ä¸­æ‰©å¤§æœç´¢èŒƒå›´
- å¦‚æœå­˜åœ¨ä¸šåŠ¡å†²çªï¼Œè®°å½•å†²çªå¹¶æ ‡è®°ä¸º"éœ€ç¡®è®¤"ï¼Œç»§ç»­æ‰§è¡Œ

---

### Step 2: éœ€æ±‚è§„åˆ’é˜¶æ®µ (Phase 2)

**è§’è‰²æ¿€æ´»**: PM (äº§å“ç»ç†) + PO (äº§å“è´Ÿè´£äºº)

**è‡ªåŠ¨æ‰§è¡Œå†…å®¹**:

```yaml
phase: 2
name: éœ€æ±‚è§„åˆ’
role: PM + PO
inputs:
  - requirement-analysis.md
  - ä¸šåŠ¡çŸ¥è¯†åº“
outputs:
  - prd.md
  - epics/
  - stories/

tasks:
  - name: åˆ›å»º PRD
    action: |
      1. åŸºäºéœ€æ±‚åˆ†ææŠ¥å‘Šåˆ›å»º PRD
      2. å®šä¹‰äº§å“ç›®æ ‡å’ŒæˆåŠŸæŒ‡æ ‡
      3. è¯¦ç»†æè¿°æ¯ä¸ªåŠŸèƒ½éœ€æ±‚ (FR)
      4. å®šä¹‰éåŠŸèƒ½éœ€æ±‚ (NFR)
    output: prd.md

  - name: åˆ›å»ºå²è¯—
    action: |
      1. å°†åŠŸèƒ½éœ€æ±‚æŒ‰æ¨¡å—åˆ†ç»„ä¸ºå²è¯—
      2. å®šä¹‰æ¯ä¸ªå²è¯—çš„ä¸šåŠ¡ä»·å€¼
      3. ç¡®å®šå²è¯—é—´çš„ä¾èµ–å…³ç³»
    output: epics/

  - name: åˆ†è§£ç”¨æˆ·æ•…äº‹
    action: |
      1. å°†æ¯ä¸ªå²è¯—åˆ†è§£ä¸ºç”¨æˆ·æ•…äº‹
      2. ä½¿ç”¨ INVEST åŸåˆ™éªŒè¯æ•…äº‹è´¨é‡
      3. å®šä¹‰æ¥å—æ ‡å‡† (Given/When/Then)
      4. ä¼°ç®—æ•…äº‹ç‚¹
    output: stories/

  - name: PO éªŒæ”¶æ ‡å‡†å®¡æ ¸
    action: |
      1. éªŒè¯æ¯ä¸ªæ•…äº‹çš„ä¸šåŠ¡ä»·å€¼
      2. ç¡®è®¤æ¥å—æ ‡å‡†å®Œæ•´æ€§
      3. ç¡®è®¤ä¼˜å…ˆçº§æ’åº
```

**PRD æ¨¡æ¿**:

```markdown
# äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)

## 1. äº§å“æ¦‚è¿°
### 1.1 èƒŒæ™¯
### 1.2 ç›®æ ‡
### 1.3 æˆåŠŸæŒ‡æ ‡

## 2. åŠŸèƒ½éœ€æ±‚ (FRs)
### FR-001: [åŠŸèƒ½åç§°]
- **æè¿°**:
- **ç”¨æˆ·æ•…äº‹**: As a [è§’è‰²], I want [åŠŸèƒ½], So that [ä»·å€¼]
- **æ¥å—æ ‡å‡†**:
  - Given [å‰ç½®æ¡ä»¶]
  - When [æ“ä½œ]
  - Then [é¢„æœŸç»“æœ]
- **ä¼˜å…ˆçº§**: P0/P1/P2
- **çŸ¥è¯†åº“ä¾æ®**: [å¼•ç”¨çš„ä¸šåŠ¡è§„åˆ™]

## 3. éåŠŸèƒ½éœ€æ±‚ (NFRs)
### NFR-001: æ€§èƒ½è¦æ±‚
### NFR-002: å®‰å…¨è¦æ±‚
### NFR-003: å¯ç”¨æ€§è¦æ±‚

## 4. ä¾èµ–å’Œçº¦æŸ
## 5. é£é™©å’Œç¼“è§£æªæ–½
```

**è´¨é‡é—¨ç¦**:
- [ ] PRD è¦†ç›–æ‰€æœ‰å·²è¯†åˆ«çš„åŠŸèƒ½ç‚¹
- [ ] æ¯ä¸ªæ•…äº‹éƒ½æœ‰æ˜ç¡®çš„æ¥å—æ ‡å‡†
- [ ] æ•…äº‹ç‚¹ä¼°ç®—å®Œæˆ
- [ ] ä¼˜å…ˆçº§æ’åºå®Œæˆ

---

### Step 3: æ¶æ„è®¾è®¡é˜¶æ®µ (Phase 3)

**è§’è‰²æ¿€æ´»**: Architect (æ¶æ„å¸ˆ)

**è‡ªåŠ¨æ‰§è¡Œå†…å®¹**:

```yaml
phase: 3
name: æ¶æ„è®¾è®¡
role: Architect
inputs:
  - prd.md
  - epics/
  - æŠ€æœ¯çŸ¥è¯†åº“
  - ç°æœ‰ä»£ç åº“
outputs:
  - architecture.md
  - adr/

tasks:
  - name: åˆ†æç°æœ‰æ¶æ„
    action: |
      1. æ‰«æç›®æ ‡ä»£ç åº“ç»“æ„
      2. è¯†åˆ«ç°æœ‰æŠ€æœ¯æ ˆ
      3. è¯†åˆ«ç°æœ‰æ¶æ„æ¨¡å¼
      4. è¯†åˆ«å¯å¤ç”¨ç»„ä»¶

  - name: è®¾è®¡æŠ€æœ¯æ–¹æ¡ˆ
    action: |
      1. åŸºäº PRD è®¾è®¡æŠ€æœ¯å®ç°æ–¹æ¡ˆ
      2. åŒ¹é…æŠ€æœ¯çŸ¥è¯†åº“ä¸­çš„æœ€ä½³å®è·µ
      3. è®¾è®¡æ–°å¢ç»„ä»¶å’Œæ¨¡å—
      4. è®¾è®¡ API æ¥å£

  - name: æ•°æ®æ¨¡å‹è®¾è®¡
    action: |
      1. è®¾è®¡æ–°å¢/å˜æ›´çš„æ•°æ®è¡¨
      2. åˆ›å»º ER å›¾
      3. è®¾è®¡æ•°æ®è¿ç§»ç­–ç•¥

  - name: æŠ€æœ¯å†³ç­–è®°å½•
    action: |
      1. è®°å½•å…³é”®æŠ€æœ¯é€‰å‹
      2. è®°å½•é€‰å‹ç†ç”±å’Œæƒè¡¡
      3. å¼•ç”¨æŠ€æœ¯çŸ¥è¯†åº“ä¾æ®
    output: adr/
```

**æ¶æ„æ–‡æ¡£æ¨¡æ¿**:

```markdown
# æ¶æ„è®¾è®¡æ–‡æ¡£

## 1. ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ
### 1.1 æ¶æ„å›¾
[Mermaid å›¾]

### 1.2 ç»„ä»¶è¯´æ˜

## 2. æŠ€æœ¯å†³ç­–
### ADR-001: [å†³ç­–æ ‡é¢˜]
- **çŠ¶æ€**: å·²é‡‡çº³
- **ä¸Šä¸‹æ–‡**: [ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªå†³ç­–]
- **å†³ç­–**: [å…·ä½“å†³ç­–å†…å®¹]
- **ç†ç”±**: [ä¸ºä»€ä¹ˆè¿™æ ·å†³ç­–]
- **çŸ¥è¯†åº“ä¾æ®**: [å¼•ç”¨çš„æŠ€æœ¯è§„èŒƒ]

## 3. æ•°æ®æ¨¡å‹
### 3.1 ER å›¾
### 3.2 è¡¨ç»“æ„è®¾è®¡

## 4. API è®¾è®¡
### 4.1 æ–°å¢æ¥å£
### 4.2 å˜æ›´æ¥å£

## 5. æ–‡ä»¶å˜æ›´æ¸…å•
| æ–‡ä»¶è·¯å¾„ | å˜æ›´ç±»å‹ | è¯´æ˜ |
|---------|---------|------|
```

**è´¨é‡é—¨ç¦**:
- [ ] æ¶æ„è®¾è®¡è¦†ç›–æ‰€æœ‰åŠŸèƒ½éœ€æ±‚
- [ ] æŠ€æœ¯å†³ç­–éƒ½æœ‰çŸ¥è¯†åº“ä¾æ®
- [ ] æ•°æ®æ¨¡å‹è®¾è®¡å®Œæ•´
- [ ] API è®¾è®¡ç¬¦åˆç°æœ‰è§„èŒƒ

---

### Step 4: å¼€å‘å®ç°é˜¶æ®µ (Phase 4)

**è§’è‰²æ¿€æ´»**: SM (Scrum Master) + DEV (å¼€å‘è€…)

**è‡ªåŠ¨æ‰§è¡Œå†…å®¹**:

```yaml
phase: 4
name: å¼€å‘å®ç°
role: SM + DEV
inputs:
  - architecture.md
  - stories/
  - æŠ€æœ¯çŸ¥è¯†åº“
outputs:
  - å®ç°çš„ä»£ç 
  - æµ‹è¯•ä»£ç 
  - sprint-status.yaml

tasks:
  - name: Sprint è§„åˆ’
    role: SM
    action: |
      1. åŸºäºæ•…äº‹ä¼˜å…ˆçº§å’Œä¾èµ–å…³ç³»æ’åº
      2. åˆ›å»º sprint-status.yaml
      3. ç¡®å®šæ•…äº‹æ‰§è¡Œé¡ºåº

  - name: æ•…äº‹å¼€å‘å¾ªç¯
    role: DEV
    repeat: for_each_story
    action: |
      1. è¯»å–æ•…äº‹ä¸Šä¸‹æ–‡
      2. åˆ†è§£ä¸ºä»»åŠ¡å’Œå­ä»»åŠ¡
      3. TDD é©±åŠ¨å®ç°:
         a. ç¼–å†™å¤±è´¥çš„æµ‹è¯•
         b. å®ç°ä»£ç ä½¿æµ‹è¯•é€šè¿‡
         c. é‡æ„ä¼˜åŒ–
      4. ä»£ç å®¡æŸ¥
      5. æ›´æ–°æ•…äº‹çŠ¶æ€
```

**TDD æ‰§è¡Œæµç¨‹**:

```
For Each Task in Story:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ 1. ç¼–å†™æµ‹è¯• (Red)                 â”‚
  â”‚    - æ ¹æ®æ¥å—æ ‡å‡†ç¼–å†™æµ‹è¯•ç”¨ä¾‹       â”‚
  â”‚    - è¿è¡Œæµ‹è¯•ï¼Œç¡®è®¤å¤±è´¥            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 2. å®ç°ä»£ç  (Green)               â”‚
  â”‚    - ç¼–å†™æœ€å°ä»£ç ä½¿æµ‹è¯•é€šè¿‡         â”‚
  â”‚    - è¿è¡Œæµ‹è¯•ï¼Œç¡®è®¤é€šè¿‡            â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 3. é‡æ„ (Refactor)               â”‚
  â”‚    - ä¼˜åŒ–ä»£ç ç»“æ„                 â”‚
  â”‚    - ç¡®ä¿æµ‹è¯•ä»ç„¶é€šè¿‡             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ 4. ä»£ç å®¡æŸ¥                       â”‚
  â”‚    - æ£€æŸ¥ä»£ç è´¨é‡                 â”‚
  â”‚    - æ£€æŸ¥è§„èŒƒåˆè§„æ€§               â”‚
  â”‚    - æ£€æŸ¥å®‰å…¨æ€§                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è´¨é‡é—¨ç¦**:
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡
- [ ] æ— å®‰å…¨æ¼æ´
- [ ] ç¬¦åˆä»£ç è§„èŒƒ

---

### Step 5: æµ‹è¯•éªŒè¯é˜¶æ®µ (Phase 5)

**è§’è‰²æ¿€æ´»**: TEA (æµ‹è¯•æ¶æ„å¸ˆ)

**è‡ªåŠ¨æ‰§è¡Œå†…å®¹**:

```yaml
phase: 5
name: æµ‹è¯•éªŒè¯
role: TEA
inputs:
  - å®ç°çš„ä»£ç 
  - æµ‹è¯•ä»£ç 
  - prd.md
outputs:
  - test-report.md
  - quality-report.md

tasks:
  - name: æ‰§è¡Œæµ‹è¯•å¥—ä»¶
    action: |
      1. è¿è¡Œå•å…ƒæµ‹è¯•
      2. è¿è¡Œé›†æˆæµ‹è¯•
      3. æ”¶é›†æµ‹è¯•è¦†ç›–ç‡

  - name: è´¨é‡é—¨ç¦æ£€æŸ¥
    action: |
      1. æ£€æŸ¥æµ‹è¯•è¦†ç›–ç‡ >= 80%
      2. æ£€æŸ¥æ— å¤±è´¥æµ‹è¯•
      3. æ£€æŸ¥ä»£ç è´¨é‡æŒ‡æ ‡
      4. æ£€æŸ¥å®‰å…¨æ‰«æç»“æœ

  - name: ç”ŸæˆæŠ¥å‘Š
    action: |
      1. ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
      2. ç”Ÿæˆè´¨é‡æŠ¥å‘Š
      3. ç”Ÿæˆè¿½æº¯çŸ©é˜µ
```

**è´¨é‡é—¨ç¦**:
- [ ] æµ‹è¯•è¦†ç›–ç‡ >= 80%
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ— ä¸¥é‡å®‰å…¨æ¼æ´
- [ ] ä»£ç è´¨é‡è¯„åˆ† >= B

---

## é˜»å¡å¤„ç†æœºåˆ¶

å½“æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é˜»å¡æ—¶ï¼ŒæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§å¤„ç†ï¼š

```yaml
blocking_resolution:
  level_1_knowledge_base:
    description: é¦–å…ˆåœ¨çŸ¥è¯†åº“ä¸­æ£€ç´¢è§£å†³æ–¹æ¡ˆ
    actions:
      - æ‰©å¤§å…³é”®è¯æœç´¢èŒƒå›´
      - æ£€ç´¢ç›¸ä¼¼é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ
      - æŸ¥æ‰¾ç›¸å…³æŠ€æœ¯æ–‡æ¡£

  level_2_inference:
    description: åŸºäºçŸ¥è¯†åº“æ¨æ–­è§£å†³æ–¹æ¡ˆ
    actions:
      - åŸºäºç›¸ä¼¼æ¡ˆä¾‹æ¨æ–­
      - åŸºäºæŠ€æœ¯è§„èŒƒæ¨æ–­
      - åŸºäºæœ€ä½³å®è·µæ¨æ–­

  level_3_default:
    description: ä½¿ç”¨é»˜è®¤ç­–ç•¥ç»§ç»­æ‰§è¡Œ
    actions:
      - é‡‡ç”¨ä¿å®ˆçš„é»˜è®¤å®ç°
      - è®°å½•å†³ç­–ä¾›åç»­å®¡æŸ¥
      - ç»§ç»­æ‰§è¡Œåç»­æ­¥éª¤

  level_4_human:
    description: æ ‡è®°ä¸ºéœ€äººå·¥ä»‹å…¥ï¼ˆæœ€åæ‰‹æ®µï¼‰
    actions:
      - è®°å½•è¯¦ç»†çš„é˜»å¡ä¿¡æ¯
      - æš‚åœå½“å‰ä»»åŠ¡
      - ç»§ç»­æ‰§è¡Œå…¶ä»–æ— ä¾èµ–ä»»åŠ¡
```

---

## çŠ¶æ€è¿½è¸ª

æ‰§è¡Œè¿‡ç¨‹ä¸­è‡ªåŠ¨æ›´æ–° `auto-iteration-status.yaml`:

```yaml
# auto-iteration-status.yaml
execution:
  id: "iter-2024-001"
  started_at: "2024-01-15T10:00:00Z"
  status: "in_progress"  # pending | in_progress | completed | blocked

phases:
  phase_1_analyze:
    status: "completed"
    started_at: "2024-01-15T10:00:00Z"
    completed_at: "2024-01-15T10:15:00Z"
    outputs:
      - requirement-analysis.md

  phase_2_plan:
    status: "completed"
    outputs:
      - prd.md
      - epics/epic-001.md
      - stories/story-001.md

  phase_3_design:
    status: "in_progress"
    current_task: "æ•°æ®æ¨¡å‹è®¾è®¡"

  phase_4_develop:
    status: "pending"

  phase_5_test:
    status: "pending"

blocking_issues: []

knowledge_base_queries:
  - query: "ç”¨æˆ·è®¤è¯æœ€ä½³å®è·µ"
    result: "found"
    source: "tech-kb/auth-patterns.md"
```

---

## æ‰§è¡Œå®Œæˆ

å½“æ‰€æœ‰é˜¶æ®µå®Œæˆåï¼Œè¾“å‡ºæœ€ç»ˆæŠ¥å‘Šï¼š

```markdown
# è¿­ä»£å¼€å‘æ‰§è¡ŒæŠ¥å‘Š

## æ‰§è¡Œæ‘˜è¦
- **æ‰§è¡Œ ID**: iter-2024-001
- **å¼€å§‹æ—¶é—´**: 2024-01-15 10:00:00
- **å®Œæˆæ—¶é—´**: 2024-01-15 14:30:00
- **æ€»è€—æ—¶**: 4.5 å°æ—¶
- **çŠ¶æ€**: âœ… æˆåŠŸå®Œæˆ

## äº§å‡ºç‰©æ¸…å•
### æ–‡æ¡£
- [ ] requirement-analysis.md
- [ ] prd.md
- [ ] architecture.md
- [ ] test-report.md

### ä»£ç 
- [ ] æ–°å¢æ–‡ä»¶: 12 ä¸ª
- [ ] ä¿®æ”¹æ–‡ä»¶: 8 ä¸ª
- [ ] æµ‹è¯•æ–‡ä»¶: 15 ä¸ª

### æµ‹è¯•ç»“æœ
- å•å…ƒæµ‹è¯•: 45/45 é€šè¿‡
- é›†æˆæµ‹è¯•: 12/12 é€šè¿‡
- è¦†ç›–ç‡: 87%

## çŸ¥è¯†åº“ä½¿ç”¨ç»Ÿè®¡
- ä¸šåŠ¡è§„åˆ™åŒ¹é…: 23 æ¡
- æŠ€æœ¯è§„èŒƒå¼•ç”¨: 15 æ¡
- æ–°å¢çŸ¥è¯†å»ºè®®: 3 æ¡

## åç»­å»ºè®®
1. [å»ºè®®å†…å®¹]
2. [å»ºè®®å†…å®¹]
```

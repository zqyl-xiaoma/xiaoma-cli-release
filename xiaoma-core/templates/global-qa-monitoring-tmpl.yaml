# Global Quality Assurance Monitoring Template
# ÂÖ®Â±ÄË¥®Èáè‰øùËØÅÁõëÊéßÊ®°Êùø

meta:
  name: "Global QA Monitoring Dashboard"
  version: "2.0"
  description: "Â∑•‰ΩúÊµÅÁä∂ÊÄÅÁõëÊéß‰∏éË¥®Èáè‰øùËØÅËøΩË∏™Ê®°Êùø"
  created_date: "2025-09-10"
  template_type: "monitoring_dashboard"

# ========== ÂÆûÊó∂ÁõëÊéßÈù¢Êùø ==========
real_time_dashboard:
  # Â∑•‰ΩúÊµÅÁä∂ÊÄÅÊÄªËßà
  workflow_status_overview:
    title: "üéØ Â∑•‰ΩúÊµÅÊâßË°åÁä∂ÊÄÅ"
    widgets:
      - widget: "current_phase"
        display: "Large Status Badge"
        data_source: "workflow_state_machine"
        refresh_rate: "5_seconds"

      - widget: "progress_bar"
        display: "Animated Progress Bar"
        calculation: "completed_steps / total_steps * 100"
        show_percentage: true

      - widget: "time_elapsed"
        display: "Digital Clock"
        format: "HH:MM:SS"
        color_coding: true # ÁªøËâ≤Ê≠£Â∏∏ÔºåÈªÑËâ≤Ë≠¶ÂëäÔºåÁ∫¢Ëâ≤Ë∂ÖÊó∂

      - widget: "next_milestone"
        display: "Countdown Timer"
        shows: "time_to_next_phase"
        alert_threshold: "30_minutes"

  # Ë¥®ÈáèÊåáÊ†á‰ª™Ë°®Áõò
  quality_metrics_dashboard:
    title: "üìä Ë¥®ÈáèÊåáÊ†áÂÆûÊó∂ÁõëÊéß"
    layout: "grid_2x3"

    metrics:
      - metric: "overall_quality_score"
        display: "Circular Gauge"
        range: [0, 100]
        target: 95
        color_zones:
          critical: [0, 70] # Á∫¢Ëâ≤
          warning: [70, 85] # ÈªÑËâ≤
          good: [85, 95] # ËìùËâ≤
          excellent: [95, 100] # ÁªøËâ≤

      - metric: "requirement_coverage"
        display: "Progress Ring"
        target: 100
        show_percentage: true
        alerts:
          - threshold: 90
            message: "ÈúÄÊ±ÇË¶ÜÁõñÂ∫¶‰Ωé‰∫é90%"

      - metric: "story_completeness_avg"
        display: "Horizontal Bar Chart"
        breakdown: ["excellent", "good", "needs_improvement", "incomplete"]

      - metric: "code_quality_trend"
        display: "Line Chart"
        time_range: "last_24_hours"
        y_axis: [0, 100]
        trend_line: true

      - metric: "test_coverage"
        display: "Donut Chart"
        segments: ["unit_tests", "integration_tests", "e2e_tests"]
        target: 90

      - metric: "defect_density"
        display: "Heatmap"
        dimensions: ["component", "severity"]
        color_scale: "red_to_green_inverted"

  # ÈóÆÈ¢òËøΩË∏™Èù¢Êùø
  issue_tracking_panel:
    title: "üö® ÈóÆÈ¢òËØÜÂà´‰∏éÂ§ÑÁêÜÁä∂ÊÄÅ"

    issue_summary:
      - widget: "issue_count_by_severity"
        display: "Stacked Bar Chart"
        categories: ["critical", "high", "medium", "low"]
        colors: ["#FF0000", "#FF8800", "#FFAA00", "#00AA00"]

      - widget: "resolution_progress"
        display: "Kanban Board"
        columns: ["identified", "assigned", "in_progress", "validation", "resolved"]
        drag_drop: false # Âè™ËØªËßÜÂõæ

      - widget: "sla_compliance"
        display: "Traffic Light Status"
        rules:
          green: "all_sla_met"
          yellow: "sla_at_risk"
          red: "sla_breached"

    active_fixes:
      - widget: "fix_execution_timeline"
        display: "Gantt Chart"
        shows: ["agent", "task", "start_time", "estimated_completion"]

      - widget: "agent_workload"
        display: "Resource Utilization Chart"
        agents: ["sm", "dev", "qa", "architect"]
        metrics: ["active_tasks", "queue_depth", "avg_resolution_time"]

  # Âæ™ÁéØË¥®Èáè‰øùËØÅÁä∂ÊÄÅ
  qa_loop_monitor:
    title: "üîÑ Ë¥®Èáè‰øùËØÅÂæ™ÁéØÁõëÊéß"

    loop_visualization:
      - widget: "loop_iteration_counter"
        display: "Large Number Display"
        current_iteration: true
        max_iterations: 5
        warning_threshold: 3

      - widget: "convergence_trend"
        display: "Multi-Line Chart"
        lines: ["quality_score", "issue_count", "coverage_percentage"]
        shows_convergence: true

      - widget: "loop_decision_tree"
        display: "Interactive Flowchart"
        shows: "current_decision_point"
        highlights: "active_path"

    exit_criteria_status:
      - widget: "exit_criteria_checklist"
        display: "Status List"
        items:
          - "Êó†ÂÖ≥ÈîÆÈóÆÈ¢ò": "status_icon"
          - "Êó†È´ò‰ºòÂÖàÁ∫ßÈóÆÈ¢ò": "status_icon"
          - "Ë¥®ÈáèÂàÜÊï∞>90": "progress_bar"
          - "ÈúÄÊ±Ç100%Ë¶ÜÁõñ": "progress_bar"
        refresh_rate: "10_seconds"

# ========== ÂëäË≠¶‰∏éÈÄöÁü•Á≥ªÁªü ==========
alerting_system:
  alert_levels:
    critical:
      conditions:
        - "workflow_stuck_for > 30_minutes"
        - "quality_score < 70"
        - "critical_defect_found"
        - "sla_breach_imminent"
      actions:
        - immediate_notification
        - escalate_to_supervisor
        - auto_intervention_trigger
      channels: ["email", "slack", "sms", "dashboard_popup"]

    warning:
      conditions:
        - "quality_degradation > 10%"
        - "loop_iteration > 3"
        - "agent_unresponsive > 15_minutes"
        - "resource_utilization > 85%"
      actions:
        - notification_to_team
        - increase_monitoring_frequency
      channels: ["email", "slack", "dashboard_notification"]

    info:
      conditions:
        - "milestone_achieved"
        - "quality_improvement_detected"
        - "loop_convergence_progress"
      actions:
        - log_event
        - update_dashboard
      channels: ["dashboard_notification", "log_file"]

  notification_templates:
    critical_alert: |
      üö® CRITICAL ALERT: {{alert_type}}

      Workflow: {{workflow_name}}
      Current Phase: {{current_phase}}
      Issue: {{issue_description}}

      Immediate Action Required:
      {{recommended_action}}

      Dashboard: {{dashboard_url}}

    progress_update: |
      üìà Progress Update: {{workflow_name}}

      Phase: {{current_phase}} ({{progress_percentage}}%)
      Quality Score: {{quality_score}}/100
      Issues: {{active_issues_count}}

      Next Milestone: {{next_milestone}}
      ETA: {{estimated_completion}}

# ========== ÂéÜÂè≤Êï∞ÊçÆ‰∏éË∂ãÂäøÂàÜÊûê ==========
historical_analysis:
  trend_charts:
    quality_evolution:
      chart_type: "line_chart"
      time_range: "configurable" # 1hour, 4hours, 24hours, 7days
      metrics:
        - overall_quality_score
        - requirement_coverage
        - defect_density
        - resolution_rate
      annotations:
        - milestone_markers
        - intervention_points
        - quality_gates_passed

    performance_benchmarks:
      chart_type: "comparison_chart"
      compares: ["current_run", "historical_average", "best_practice"]
      metrics:
        - total_execution_time
        - loop_iterations_count
        - fix_success_rate
        - sla_compliance_rate

    agent_performance:
      chart_type: "radar_chart"
      agents: ["sm", "dev", "qa", "architect", "auditor"]
      dimensions:
        - task_completion_rate
        - quality_of_output
        - response_time
        - error_rate
        - learning_efficiency

  pattern_recognition:
    common_issues:
      - issue_pattern: "story_quality_degradation"
        frequency: "daily_analysis"
        root_causes: ["template_deviation", "requirement_ambiguity"]

      - issue_pattern: "loop_convergence_slowdown"
        frequency: "per_loop_analysis"
        root_causes: ["complex_fixes", "interdependent_issues"]

      - issue_pattern: "agent_performance_variance"
        frequency: "weekly_analysis"
        root_causes: ["workload_imbalance", "skill_gaps"]

    predictive_insights:
      - prediction: "loop_iteration_forecast"
        algorithm: "regression_analysis"
        accuracy_target: "85%"

      - prediction: "completion_time_estimate"
        algorithm: "monte_carlo_simulation"
        confidence_interval: "95%"

      - prediction: "quality_score_projection"
        algorithm: "trend_extrapolation"
        adjustment_factors: ["current_issues", "fix_complexity"]

# ========== ‰∫§‰∫íÂºèÊìç‰ΩúÁïåÈù¢ ==========
interactive_controls:
  workflow_controls:
    - control: "pause_workflow"
      permission: "supervisor"
      confirmation: required

    - control: "skip_quality_gate"
      permission: "architect"
      requires_justification: true

    - control: "force_loop_exit"
      permission: "po"
      requires_approval: true

    - control: "manual_intervention"
      permission: "any_authorized"
      opens: "intervention_wizard"

  quality_adjustments:
    - adjustment: "quality_threshold"
      range: [70, 100]
      requires_justification: true
      impact_warning: true

    - adjustment: "max_loop_iterations"
      range: [1, 10]
      default: 5
      warning_at: 8

  view_customization:
    - option: "metric_selection"
      allows: "custom_dashboard_layout"

    - option: "time_range_filter"
      options: ["real_time", "1h", "4h", "24h", "7d", "custom"]

    - option: "alert_preferences"
      customizable: ["channels", "frequency", "severity_filter"]

# ========== ÂØºÂá∫ÂíåÊä•Âëä ==========
export_reporting:
  automated_reports:
    hourly_snapshot:
      content: ["current_status", "key_metrics", "active_alerts"]
      format: "json"
      recipients: ["monitoring_system", "api_consumers"]

    daily_summary:
      content: ["progress_summary", "quality_trends", "issue_resolution"]
      format: "markdown"
      recipients: ["development_team", "stakeholders"]

    completion_report:
      content: ["full_execution_trace", "quality_analysis", "lessons_learned"]
      format: "html"
      recipients: ["project_management", "quality_team"]

  on_demand_exports:
    - export_type: "dashboard_screenshot"
      format: "png"
      resolution: "1920x1080"

    - export_type: "metrics_data"
      format: "csv"
      time_range: "configurable"

    - export_type: "alert_history"
      format: "json"
      filters: ["severity", "time_range", "alert_type"]

    - export_type: "agent_performance_report"
      format: "pdf"
      includes: ["charts", "analysis", "recommendations"]

# ========== ÈõÜÊàêÈÖçÁΩÆ ==========
integration_config:
  external_systems:
    logging:
      - system: "elasticsearch"
        index_pattern: "xiaoma-qa-monitoring-*"

      - system: "prometheus"
        metrics_endpoint: "/metrics"
        scrape_interval: "30s"

    notifications:
      - system: "slack"
        webhook_url: "{{SLACK_WEBHOOK}}"
        channels: ["#quality-alerts", "#development-team"]

      - system: "email"
        smtp_config: "{{EMAIL_CONFIG}}"
        distribution_lists: ["qa-team", "management"]

    storage:
      - system: "mongodb"
        collection: "qa_monitoring_data"
        retention: "90_days"

      - system: "redis"
        usage: "real_time_cache"
        ttl: "1_hour"

  api_endpoints:
    - endpoint: "/api/v1/workflow/status"
      method: "GET"
      returns: "current_workflow_state"

    - endpoint: "/api/v1/quality/metrics"
      method: "GET"
      parameters: ["time_range", "metric_types"]

    - endpoint: "/api/v1/issues/active"
      method: "GET"
      returns: "active_issues_list"

    - endpoint: "/api/v1/alerts/subscribe"
      method: "POST"
      allows: "webhook_registration"

# ========== ÈÖçÁΩÆÊ®°Êùø ==========
configuration_template:
  monitor_settings:
    refresh_intervals:
      real_time_data: 5 # seconds
      quality_metrics: 30 # seconds
      historical_data: 300 # seconds (5 minutes)

    data_retention:
      real_time_cache: "1_hour"
      detailed_metrics: "7_days"
      summary_data: "90_days"
      alert_history: "1_year"

    performance_limits:
      max_concurrent_widgets: 20
      chart_data_points: 1000
      alert_queue_size: 500

  customization_options:
    theme: ["dark", "light", "auto"]
    language: ["zh-CN", "en-US"]
    timezone: "auto_detect"
    number_format: "locale_based"

    default_views:
      - "executive_summary"
      - "technical_details"
      - "quality_focus"
      - "operations_center"

    role_based_access:
      developer: ["code_quality", "implementation_status"]
      qa_engineer: ["test_coverage", "defect_tracking"]
      project_manager: ["progress_overview", "milestone_tracking"]
      architect: ["system_health", "technical_debt"]
      executive: ["business_metrics", "risk_assessment"]

# ========== ÊàêÂäüÂ∫¶ÈáèÊ†áÂáÜ ==========
success_metrics:
  monitoring_effectiveness:
    - "ÈóÆÈ¢òÊ£ÄÊµãÊó∂Èó¥ < 5ÂàÜÈíü"
    - "È¢ÑÊµãÂáÜÁ°ÆÁéá > 85%"
    - "ÂëäË≠¶ËØØÊä•Áéá < 5%"
    - "Á≥ªÁªüÂèØÁî®ÊÄß > 99.9%"

  Áî®Êà∑‰ΩìÈ™å:
    - "‰ª™Ë°®ÊùøÂìçÂ∫îÊó∂Èó¥ < 2Áßí"
    - "Êï∞ÊçÆÂà∑Êñ∞Âª∂Ëøü < 10Áßí"
    - "Áî®Êà∑Êª°ÊÑèÂ∫¶ > 90%"
    - "Ëá™Âä©ÊúçÂä°Áéá > 80%"

  business_value:
    - "ÂÜ≥Á≠ñÊîØÊåÅÂèäÊó∂ÊÄßÊèêÂçá > 70%"
    - "ÈóÆÈ¢òËß£ÂÜ≥ÈÄüÂ∫¶ÊèêÂçá > 50%"
    - "Ë¥®ÈáèÂèØËßÜÊÄßÊîπÂñÑ > 90%"
    - "Âõ¢ÈòüÂçè‰ΩúÊïàÁéáÊèêÂçá > 60%"

# Requirements Coverage Audit Task

# 需求覆盖度审计任务

## 任务概述

系统性检查和验证产品需求到用户故事的转化完整性和实施状态，确保所有PRD需求都被正确转化为用户故事并得到有效实施。

## 核心功能

### 📋 需求转化检查

- PRD文档需求是否完全转化为用户故事
- 史诗级需求的用户故事覆盖度分析
- 需求优先级和实施状态匹配度验证

### ✅ 用户故事完整性检查

- 验证用户故事包含完整的验收标准
- 检查数据库设计是否完整实施
- 确认API接口是否完全实现
- 评估任务分解是否合理且完成

### 🎯 实施状态验证

- 用户故事状态的准确性检查
- 开发任务的完成度评估
- QA结果的真实性验证
- 交付物的完整性确认

## 使用方法

### 基础审计

```bash
*requirements-coverage-audit
```

### 专注特定史诗的审计

```bash
*coverage-audit --epic=史诗-1基础设施与核心文档展示
```

### 验证用户故事状态准确性

```bash
*story-validation --focus=implementation-status
```

## 执行流程

### 第一阶段：需求源文档分析 (5-8分钟)

1. **加载PRD文档**
   - 读取主PRD文档
   - 扫描docs/prd/目录下的史诗文件
   - 提取所有需求和用户故事定义
   - 构建需求层次结构

2. **提取需求矩阵**
   - 识别所有史诗和用户故事
   - 提取验收标准和功能点
   - 分析需求优先级
   - 构建需求依赖关系

### 第二阶段：用户故事实施分析 (8-12分钟)

1. **扫描已实施用户故事**
   - 扫描docs/stories/目录
   - 解析每个用户故事文档
   - 提取实施状态和完成度
   - 分析任务完成情况

2. **分析用户故事完整性**
   - 检查必需章节完整性
   - 验证数据库设计实施
   - 检查API接口实现
   - 分析任务分解和完成度

### 第三阶段：覆盖度映射和差距分析 (5-8分钟)

1. **需求到故事映射**
   - 建立需求-用户故事映射关系
   - 识别已实施的需求
   - 识别未实施的需求
   - 分析实施覆盖度

2. **识别差距和问题**
   - 识别需求覆盖差距
   - 发现不一致的实施状态
   - 分析质量问题
   - 生成改进建议

### 第四阶段：生成综合审计报告 (2-5分钟)

1. **生成覆盖度报告**
   - 计算整体覆盖度指标
   - 生成需求实施矩阵
   - 创建可视化图表
   - 提供详细分析

2. **生成行动计划**
   - 优先级排序未实施需求
   - 制定实施路线图
   - 生成具体行动项
   - 估算工作量

## 检查维度

### 1. 需求覆盖度分析

- **最低覆盖度**：95%
- **关键需求覆盖**：100%
- **指标**：总需求数量、已转化需求数量、覆盖度百分比、未覆盖需求清单

### 2. 用户故事完整性分析

- **结构完整性**：30% 权重
- **内容质量**：40% 权重
- **实施细节**：30% 权重
- **检查项**：必需章节、验收标准、数据库设计、API接口规范、任务分解

### 3. 实施状态准确性验证

- 状态声明与实际内容匹配度
- QA结果的真实性
- 开发者记录的完整性
- 交付物的存在性

### 4. 业务价值实现分析

- 关键功能实施状态
- 用户价值主张实现度
- 业务目标达成情况
- ROI预期实现度

## 输出报告

### 主要报告

- **需求覆盖度审计报告**：执行摘要、详细分析、改进建议
- **实施差距分析报告**：差距矩阵、优先级排序、行动项

### 数据导出

- **需求矩阵**：结构化需求映射数据 (JSON)
- **覆盖度指标**：覆盖度指标数据 (JSON)
- **完整性评分**：用户故事完整性评分 (JSON)

## 质量检查规则

### 用户故事必需元素

- **用户故事格式**：作为...我希望...以便... (HIGH)
- **验收标准**：至少3条编号列表 (HIGH)
- **数据库设计相关**：实体、操作、约束 (MEDIUM)
- **API接口规范**：端点、设计、映射关系 (HIGH)
- **开发者记录**：代理模型、实现记录、文件列表 (LOW)

### 实施状态验证规则

- **Completed**：需要QA结果、开发记录、文件列表、验收标准实施
- **InProgress**：需要部分验收标准实施记录和开发记录
- **Draft**：需要基本结构完整

## 成功标准

### 审计完整性

- 所有PRD需求识别和分类
- 所有用户故事完整性评估
- 覆盖度映射100%完成
- 差距分析全面准确

### 报告质量

- 执行摘要清晰简明
- 分析数据准确可靠
- 改进建议具体可行
- 行动计划优先级明确

### 可执行洞察

- 识别具体的覆盖度差距
- 提供可执行的改进建议
- 制定合理的实施时间表
- 估算准确的工作量

## 预期时长

**总计**：20-30 分钟

## 相关文件

- **模板文件**：`xiaoma-core/templates/requirements-coverage-audit.yaml`
- **输出位置**：`audit-reports/`
- **数据源**：`docs/prd/`, `docs/stories/`
